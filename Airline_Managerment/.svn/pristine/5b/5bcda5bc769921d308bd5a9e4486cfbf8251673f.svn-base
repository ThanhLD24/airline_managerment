USE master
GO
-- Kiểm tra tồn tại của tên database
IF EXISTS (
SELECT name FROM sys.databases WHERE name = N'Airline_Managerment')
DROP DATABASE Airline_Managerment
GO
--Tạo database
CREATE DATABASE Airline_Managerment
GO

USE Airline_Managerment
GO

CREATE TABLE  dbo.PERSON(
	PERSON_ID					INT IDENTITY(1,1) NOT NULL,
	PERSON_NAME_TITLE			NVARCHAR(10) NOT NULL,
	PERSON_NAME					NVARCHAR(50) NOT NULL,
	PERSON_BIRTHDAY				NVARCHAR(20),
	PERSON_EMAIL				NVARCHAR(50) NOT NULL,
	PERSON_ADDRESS				NVARCHAR(100) NOT NULL,
	PERSON_NATIONALITY			NVARCHAR(20),
	PERSON_GENDER				NVARCHAR(5),
	PERSON_PHONE				NVARCHAR(15),
	PERSON_HOMEPHONE			NVARCHAR(15),
	PERSON_OFFICEPHONE			NVARCHAR(15),
	PERSON_JOB					NVARCHAR(200),
	PERSON_IDENTITY_NUMBER		NVARCHAR(15),
	PERSON_BANK_ACCOUNT_NUMBER	NVARCHAR(15),
	PERSON_APPLYYEAR			INT,
	PERSON_POSITION				NVARCHAR(100),
	PERSON_NOTES				NVARCHAR(200),
	PASSPORT					NVARCHAR(20),
	EXPIRATION_DATE				NVARCHAR(20),
	PERSON_SESSION_ID			NVARCHAR(50),
	CONSTRAINT CK_PERSON PRIMARY KEY (PERSON_ID)
)
CREATE TABLE dbo.CARRIER(
	CARRIER_ID					INT IDENTITY(1,1) NOT NULL,
	CARRIER_NAME				NVARCHAR(20) NOT NULL,
	CARRIER_HEADQUARTER			NVARCHAR(50) NOT NULL,
	CARRIER_REGISTRATION_DATE	DATE NOT NULL,
	CONSTRAINT CK_CARRIER PRIMARY KEY (CARRIER_ID)
)
CREATE TABLE dbo.AIR_PLANE(
	AIR_PLANE_ID			INT IDENTITY(1,1) NOT NULL,
	AIR_PLANE_NAME			NVARCHAR(20) NOT NULL,
	AIR_PLANE_TYPE			NVARCHAR(10) NOT NULL,
	AIR_PLANE_CAPACITY		INT NOT NULL,
	MANUFACTURER			NVARCHAR(200),
	CARRIER_ID				INT NOT NULL,
	CONSTRAINT CK_AIR_PLANE PRIMARY KEY (AIR_PLANE_ID),
	CONSTRAINT FK_AIR_PLANE_CARRIER FOREIGN KEY (CARRIER_ID) REFERENCES CARRIER(CARRIER_ID)

)
CREATE TABLE dbo.ACCOUNT(
	ACCOUNT_ID				INT IDENTITY(1,1) NOT NULL,
	PERSON_ID				INT NOT NULL,
	ACCOUNT_PASSWORD		NVARCHAR(50) NOT NULL,
	ACCOUNT_PERMIT			INT,
	CONSTRAINT CK_ACCOUNT PRIMARY KEY (ACCOUNT_ID),
	CONSTRAINT FK_ACCOUNT_PERSON FOREIGN KEY (PERSON_ID) REFERENCES PERSON(PERSON_ID)
)
CREATE TABLE dbo.TICKET(
	TICKET_ID						INT IDENTITY(1,1) NOT NULL,
	TICKET_STATE					NVARCHAR(50) NULL,
	--TICKET_ORIGIN_TIME				TIME NOT NULL,
	--TICKET_ORIGIN_DATE				DATE NOT NULL,
	TICKET_ORIGIN_TIME				NVARCHAR(10) NOT NULL,
	TICKET_ORIGIN_DATE				NVARCHAR(10) NOT NULL,
	TICKET_ORIGIN_AIRPORT_ID		NVARCHAR(4) NOT NULL,
	--TICKET_DESTINATION_TIME			TIME NOT NULL,
	--TICKET_DESTINATION_DATE			DATE NOT NULL,
	TICKET_DESTINATION_TIME			NVARCHAR(10) NOT NULL,
	TICKET_DESTINATION_DATE			NVARCHAR(10) NOT NULL,
	TICKET_DESTINATION_AIRPORT_ID	NVARCHAR(4) NOT NULL,
	TICKET_PRICE_ADULT				NVARCHAR(20) NOT NULL,
	TICKET_PRICE_CHILD				NVARCHAR(20) NOT NULL,
	TICKET_PRICE_INFANT				NVARCHAR(20) NOT NULL,
	TICKET_TAX_ADULT				NVARCHAR(20) NOT NULL,
	TICKET_TAX_CHILD				NVARCHAR(20) NOT NULL,
	TICKET_TAX_INFANT				NVARCHAR(20) NOT NULL,
	TICKET_SALE						NVARCHAR(20) NOT NULL,
	TICKET_CURRENCY					NVARCHAR(5) NOT NULL,
	AIR_PLANE_ID					INT NOT NULL,
	TICKET_AVAILABLE				BIT NOT NULL,
	TICKET_COUNT					INT NOT NULL,
	CONSTRAINT CK_TICKET PRIMARY KEY (TICKET_ID),
	CONSTRAINT FK_TICKET_AIR_PLANE FOREIGN KEY (AIR_PLANE_ID) REFERENCES AIR_PLANE(AIR_PLANE_ID)
)

CREATE TABLE dbo.AIRPORT(
	AIRPORT_ID 						NVARCHAR(4) NOT NULL,
	AIRPORT_NAME 					NVARCHAR(50) NOT NULL,
	AIRPORT_POSITION				NVARCHAR(100),
	AIRPORT_DESCRIPTION				NVARCHAR(100),
	CONSTRAINT CK_AIRPORT PRIMARY KEY (AIRPORT_ID)
)
CREATE TABLE dbo.ORDER_TICKET(
	ORDER_TICKET_ID					INT IDENTITY(1000,1) NOT NULL,
	TICKET_ID						INT NOT NULL,
	PERSON_ID						INT NOT NULL,
	ORDER_TICKET_PASSENGER			NVARCHAR(500) NOT NULL,
	ORDER_TICKET_LUGGAGE			NVARCHAR(200) NULL,
	ORDER_TICKET_TOTAL_PRICE		NVARCHAR(10) NOT NULL,
	ORDER_TICKET_DATE				NVARCHAR(10) NULL,
	ORDER_TICKET_OTHER				NVARCHAR(200) NULL,
	CONSTRAINT CK_ORDER_TICKET PRIMARY KEY (ORDER_TICKET_ID),
	CONSTRAINT FK_ORDER_TICKET_PERSON FOREIGN KEY (PERSON_ID) REFERENCES PERSON(PERSON_ID),
	CONSTRAINT FK_ORDER_TICKET_TICKET FOREIGN KEY (TICKET_ID) REFERENCES TICKET(TICKET_ID)
)
GO

INSERT INTO dbo.PERSON VALUES(N'Ông', N'Lê Duy Thanh', '02/04/1994', 'thanhld@gmail.com', 'Tu Liem', 'Viet Nam', 'Nam', '125443', '56734', '678546', 'IT SOFTWARE', '152023610', 'A701SS', 4, 'DEV', 'NO NOTES', 'P3456S', '02/02/2017','')
INSERT INTO dbo.PERSON VALUES(N'Ông', N'Nguyễn Duy Hoàng', '02/04/1994', 'hoangnd@gmail.com', 'Tu Liem', 'Viet Nam', 'Nam', '125443', '56734', '678546', 'IT SOFTWARE', '152023610', 'A701SS', 4, 'DEV', 'NO NOTES', 'P3456S', '02/02/2017','')
INSERT INTO dbo.PERSON VALUES(N'Bà', N'Đông Phương Bất Bại', '12/05/1994', 'hoangnd@gmail.com', 'Tu Liem', 'Viet Nam', 'Nam', '125443', '56734', '678546', 'IT SOFTWARE', '152023610', 'A701SS', 4, 'DEV', 'NO NOTES', 'P3456S', '02/02/2017','')
GO

INSERT INTO dbo.CARRIER VALUES('Vietnam Airlines', 'HA NOI', '1-1-2015')
INSERT INTO dbo.CARRIER VALUES('VASCO', 'HA NOI', '2-2-2015')
INSERT INTO dbo.CARRIER VALUES('Jetstar Pacifics', 'TPHCM', '3-3-2015')
INSERT INTO dbo.CARRIER VALUES('Vietjet Air', 'HA NOI', '4-4-2015')

GO

INSERT INTO dbo.AIR_PLANE VALUES('BOEING 777', 'CIVIL', 309, 'BOEING', 1)
INSERT INTO dbo.AIR_PLANE VALUES('AIRBUS A 300', 'CIVIL', 280, 'AIRBUS', 1)
INSERT INTO dbo.AIR_PLANE VALUES('AIRBUS A 330', 'CIVIL', 300, 'AIRBUS', 1)
INSERT INTO dbo.AIR_PLANE VALUES('FOKKER 70', 'CIVIL', 309, 'FOKKER', 1)
INSERT INTO dbo.AIR_PLANE VALUES('AIRBUS A 310', 'CIVIL', 230, 'AIRBUS', 3)
INSERT INTO dbo.AIR_PLANE VALUES('AIRBUS A 320', 'CIVIL', 310, 'AIRBUS', 3)

GO 

INSERT INTO dbo.AIRPORT VALUES('HAN',N'Nội Bài',N'Hà Nội','')
INSERT INTO dbo.AIRPORT VALUES('HPH',N'Nội Bài',N'Hải Phòng','')
INSERT INTO dbo.AIRPORT VALUES('DIN',N'Nội Bài',N'Điện Biên','')
INSERT INTO dbo.AIRPORT VALUES('THD',N'Nội Bài',N'Thanh Hóa','')
INSERT INTO dbo.AIRPORT VALUES('SGN',N'Tân Sơn Nhất',N'Hồ Chí Minh','')
INSERT INTO dbo.AIRPORT VALUES('DLI',N'Nội Bài',N'Đà Lạt','')
INSERT INTO dbo.AIRPORT VALUES('VII',N'Nội Bài',N'Vinh','')
INSERT INTO dbo.AIRPORT VALUES('HUI',N'Nội Bài',N'Huế','')
INSERT INTO dbo.AIRPORT VALUES('VDH',N'Nội Bài',N'Đồng Hới','')
INSERT INTO dbo.AIRPORT VALUES('DAD',N'Nội Bài',N'Đà Nẵng','')
INSERT INTO dbo.AIRPORT VALUES('PXU',N'Nội Bài',N'Pleiku','')
INSERT INTO dbo.AIRPORT VALUES('TBB',N'Nội Bài',N'Tuy Hòa','')
INSERT INTO dbo.AIRPORT VALUES('CXR',N'Nội Bài',N'Nha Trang','')
INSERT INTO dbo.AIRPORT VALUES('PQC',N'Nội Bài',N'Phú Quốc','')
INSERT INTO dbo.AIRPORT VALUES('VCL',N'Nội Bài',N'Tam Kỳ','')
INSERT INTO dbo.AIRPORT VALUES('UIH',N'Nội Bài',N'Quy Nhơn','')
INSERT INTO dbo.AIRPORT VALUES('VCA',N'Nội Bài',N'Cần Thơ','')
INSERT INTO dbo.AIRPORT VALUES('VCS',N'Nội Bài',N'Côn Đảo','')
INSERT INTO dbo.AIRPORT VALUES('VKG',N'Nội Bài',N'Rạch Giá','')
INSERT INTO dbo.AIRPORT VALUES('CAH',N'Nội Bài',N'Cà Mau','')
INSERT INTO dbo.AIRPORT VALUES('BMT',N'Nội Bài',N'Buôn Ma Thuột','')
GO
--insert theo data time
-- phan nay bo
--INSERT INTO dbo.TICKET VALUES('','2:30:00 AM','2015-10-30','HAN','3:30:00 AM','2015-11-01','SGN',690000,N'VNĐ',2,1,1000)
--INSERT INTO dbo.TICKET VALUES('','2:30:00 AM','2015-12-01','HAN','3:30:00 AM','2015-12-02','VII',400000,N'VNĐ',2,1,1000)
--INSERT INTO dbo.TICKET VALUES('','2:30:00 AM','2015-10-30','HAN','3:30:00 AM','2015-11-01','SGN',690000,N'VNĐ',3,1,1000)
--INSERT INTO dbo.TICKET VALUES('','4:30:00 AM','2015-11-30','HAN','6:30:00 AM','2015-11-01','SGN',690000,N'VNĐ',1,1,1000)
--INSERT INTO dbo.TICKET VALUES('','2:30:00 AM','2015-10-30','HAN','3:30:00 AM','2015-11-01','CAH',690000,N'VNĐ',2,1,1000)
--GO

-- insert theo string
INSERT INTO dbo.TICKET VALUES('','2:30 AM','30/10/2015','HAN','3:30 AM','01/11/2015','SGN','390000','390000','0','300000','250000','180000','50000',N'VNĐ',2,1,1000)
GO
-- them cac truong them vao nhu ben tren thi moi them duoc, day la ban cu
-- de day ti t sua sau
INSERT INTO dbo.TICKET VALUES('','2:30 AM','1/12/2015','HAN','3:30 AM','05/12/2015','VII','400.000',N'VNĐ',2,1,1000)
INSERT INTO dbo.TICKET VALUES('','2:30 AM','30/10/2015','HAN','3:30 AM','02/11/2015','SGN','890.000',N'VNĐ',3,1,1000)
INSERT INTO dbo.TICKET VALUES('','4:30 AM','30/11/2015','HAN','6:30 AM','04/12/2015','SGN','790.000',N'VNĐ',1,1,1000)
INSERT INTO dbo.TICKET VALUES('','2:30 AM','02/11/2015','HAN','3:30 AM','04/11/2015','CAH','690.000',N'VNĐ',2,1,1000)
GO


